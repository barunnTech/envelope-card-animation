<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Envelope Card Animation</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      overflow-x: hidden;
    }

    .container {
      width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 30px;
      background:
        radial-gradient(circle at 20% 80%, rgba(102, 126, 234, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(118, 75, 162, 0.03) 0%, transparent 50%),
        linear-gradient(135deg, #fefbf6 0%, #f5f0e8 100%);
      position: relative;
    }

    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image:
        repeating-linear-gradient(
          0deg,
          transparent,
          transparent 2px,
          rgba(0, 0, 0, 0.01) 2px,
          rgba(0, 0, 0, 0.01) 4px
        ),
        repeating-linear-gradient(
          90deg,
          transparent,
          transparent 2px,
          rgba(0, 0, 0, 0.01) 2px,
          rgba(0, 0, 0, 0.01) 4px
        );
      pointer-events: none;
      opacity: 0.5;
    }

    .media-root {
      width: 100%;
      height: 100vh;
      contain: layout;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1;
    }

    .graphics {
      position: relative;
      overflow: hidden;
      opacity: 1;
      height: 100%;
      width: 100%;
    }

    .scenario {
      position: absolute;
      perspective: 1200px;
      width: inherit;
      height: inherit;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      transform-style: preserve-3d;
    }

    .scenario-child {
      position: relative;
      width: inherit;
      height: inherit;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      transform-style: preserve-3d;
    }

    .scene {
      position: absolute;
      top: 0;
      left: 0;
      transform-origin: 50% 50%;
      width: inherit;
      height: inherit;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      transform-style: preserve-3d;
    }

    /* 봉투 안 카드 */
    .envelope-card-inner {
      width: 100%;
      height: 100%;
      background:
        linear-gradient(180deg, rgba(255, 255, 255, 0.05) 0%, transparent 100%),
        linear-gradient(135deg, #ffffff 0%, #fafafa 100%);
      border-radius: 4px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(0, 0, 0, 0.05);
      position: relative;
      overflow: hidden;
    }

    .envelope-card-inner::before {
      content: '';
      position: absolute;
      top: 8px;
      left: 8px;
      right: 8px;
      bottom: 8px;
      border: 1.5px solid rgba(102, 126, 234, 0.15);
      border-radius: 2px;
      pointer-events: none;
    }

    .card-header-small {
      width: 100%;
      height: 35%;
      background:
        linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, transparent 100%),
        linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .card-header-small::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image:
        radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
      pointer-events: none;
    }

    .header-decoration {
      font-size: 32px;
      color: rgba(255, 255, 255, 0.9);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      z-index: 1;
      position: relative;
      animation: sparkle 2s ease-in-out infinite;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0.8; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }

    .card-content {
      padding: 12px 16px;
      text-align: center;
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 700;
      color: #333;
      margin: 0;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      font-family: 'Georgia', serif;
    }

    .card-subtitle {
      font-size: 10px;
      color: #666;
      margin: 0;
      font-style: italic;
      font-weight: 400;
      letter-spacing: 0.3px;
    }

    .replay-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.7);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      color: white;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(10px);
      z-index: 100;
    }

    .replay-btn:hover {
      background: rgba(0, 0, 0, 0.9);
      transform: scale(1.1);
    }

    .replay-btn:active {
      transform: scale(0.95);
    }

    .replay-btn svg {
      width: 24px;
      height: 24px;
      transition: transform 0.3s;
    }

    .replay-btn:hover svg {
      transform: rotate(-360deg);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="media-root">
      <div class="graphics" style="opacity: 1;">

        <!-- ENVELOPE -->
        <div id="envelope" class="scenario" style="
          top: 50%;
          left: 50%;
          width: 380px;
          height: 250px;
          visibility: inherit;
          cursor: pointer;
        ">
          <div class="scenario-child">

            <div id="envelope-container" style="
              position: relative;
              width: 100%;
              height: 100%;
              background-color: #8B6F47;
              overflow: visible;
            ">

              <!-- 봉투 내부 바닥 (내지 - 위쪽까지 확장) -->
              <div style="
                position: absolute;
                width: 90%;
                height: 100%;
                top: 0;
                left: 50%;
                transform: translateX(-50%);
                z-index: 0;
              ">
                <svg width="100%" height="100%" viewBox="0 0 340 250" preserveAspectRatio="none">
                  <defs>
                    <pattern id="damaskPattern" patternUnits="userSpaceOnUse" width="40" height="40" patternTransform="rotate(45)">
                      <rect width="40" height="40" fill="#F5EFE7"/>
                      <path d="M20 5 Q25 10 20 15 Q15 10 20 5 M20 25 Q25 30 20 35 Q15 30 20 25 M5 20 Q10 25 5 30 Q0 25 5 20 M35 20 Q40 25 35 30 Q30 25 35 20" fill="none" stroke="#E8DCC8" stroke-width="0.5" opacity="0.6"/>
                    </pattern>
                  </defs>
                  <rect width="340" height="250" fill="url(#damaskPattern)" rx="4"/>
                </svg>
              </div>

              <!-- 아래쪽 플랩 -->
              <svg width="335" height="173" viewBox="0 0 335 173" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" style="position: absolute; width: 100%; height: 100%; top: 3px; left: 0; z-index: 4; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));">
                <defs>
                  <linearGradient id="bottomGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="#A68B5B" />
                    <stop offset="50%" stop-color="#8B6F47" />
                    <stop offset="100%" stop-color="#6B5738" />
                  </linearGradient>
                </defs>
                <path d="M333.604 164.977C333.241 162.314 331.568 159.911 329.015 158.389L180.084 68.9955C172.529 64.4654 162.49 64.4654 154.917 68.9955L5.98593 158.372C3.43302 159.911 1.75983 162.297 1.39759 164.96L0.638619 170.562C0.569621 171.081 1.03535 171.547 1.65633 171.547H333.345C333.949 171.547 334.432 171.081 334.363 170.562L333.604 164.96V164.977Z" fill="url(#bottomGradient)" stroke="rgba(0,0,0,0.2)" stroke-width="1"/>
              </svg>

              <!-- 왼쪽 플랩 -->
              <svg width="335" height="173" viewBox="0 0 335 173" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; z-index: 2; filter: drop-shadow(-2px 0 3px rgba(0,0,0,0.15));">
                <defs>
                  <linearGradient id="leftGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" stop-color="#5D4A2F" />
                    <stop offset="100%" stop-color="#8B6F47" />
                  </linearGradient>
                </defs>
                <path d="M12.8506 0.904175H0.5V172.222C0.5 172.654 0.965734 173 1.51771 173H19.1466L155.469 90.1594C158.177 88.5168 158.177 85.4044 155.469 83.7618L24.0627 3.8782C20.8888 1.94163 16.9387 0.904175 12.8678 0.904175H12.8506Z" fill="url(#leftGradient)" stroke="rgba(0,0,0,0.2)" stroke-width="1"/>
              </svg>

              <!-- 오른쪽 플랩 -->
              <svg width="335" height="173" viewBox="0 0 335 173" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; z-index: 3; filter: drop-shadow(2px 0 3px rgba(0,0,0,0.15));">
                <defs>
                  <linearGradient id="rightGradient" x1="100%" y1="0%" x2="0%" y2="0%">
                    <stop offset="0%" stop-color="#5D4A2F" />
                    <stop offset="100%" stop-color="#8B6F47" />
                  </linearGradient>
                </defs>
                <path d="M322.132 0.904175H334.483V172.222C334.483 172.654 334.017 173 333.465 173H315.836L179.515 90.1594C176.806 88.5168 176.806 85.4044 179.515 83.7618L310.938 3.89551C314.112 1.95893 318.062 0.921483 322.132 0.921483V0.904175Z" fill="url(#rightGradient)" stroke="rgba(0,0,0,0.2)" stroke-width="1"/>
              </svg>

              <!-- 위쪽 뚜껑 -->
              <div id="envelope-flap-container" style="
                position: absolute;
                width: 100%;
                height: 50%;
                top: 0;
                left: 0;
                transform-origin: center top;
                transition: transform 0.75s cubic-bezier(0.445, 0.05, 0.55, 0.95), z-index 0s linear 0.75s;
                pointer-events: none;
                transform-style: preserve-3d;
              ">
                <!-- 뚜껑 외부 (갈색) -->
                <svg id="envelope-flap" width="334" height="125" viewBox="0 0 334 125" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" style="
                  position: absolute;
                  width: 100%;
                  height: 100%;
                  filter: drop-shadow(0 -2px 4px rgba(0,0,0,0.25));
                ">
                  <defs>
                    <linearGradient id="topGradient" x1="50%" y1="100%" x2="50%" y2="0%">
                      <stop offset="0%" stop-color="#5D4A2F" />
                      <stop offset="50%" stop-color="#74583A" />
                      <stop offset="100%" stop-color="#8B6F47" />
                    </linearGradient>
                  </defs>
                  <path d="M0.897426 7.47704C1.25968 10.4096 2.93296 13.0489 5.486 14.7222L154.425 120.673C161.981 125.659 172.02 125.659 179.593 120.673L328.532 14.7394C331.085 13.0489 332.758 10.4096 333.121 7.49429L333.88 1.31869C333.949 0.749427 333.483 0.231918 332.862 0.231918H167L1.15618 0.231918C0.552421 0.231918 0.069413 0.732176 0.138414 1.31869L0.897426 7.49429V7.47704Z" fill="url(#topGradient)" stroke="rgba(0,0,0,0.2)" stroke-width="1"/>
                </svg>

                <!-- 뚜껑 내부 (내지 - 열렸을 때만 보임, 뚜껑 모양) -->
                <div style="
                  position: absolute;
                  width: 100%;
                  height: 100%;
                  top: 0;
                  left: 0;
                  transform: rotateX(180deg) scaleY(-1);
                  z-index: 1;
                  backface-visibility: hidden;
                ">
                  <svg width="100%" height="100%" viewBox="0 0 334 125" preserveAspectRatio="none">
                    <defs>
                      <pattern id="damaskPatternTop" patternUnits="userSpaceOnUse" width="40" height="40" patternTransform="rotate(45)">
                        <rect width="40" height="40" fill="#F5EFE7"/>
                        <path d="M20 5 Q25 10 20 15 Q15 10 20 5 M20 25 Q25 30 20 35 Q15 30 20 25 M5 20 Q10 25 5 30 Q0 25 5 20 M35 20 Q40 25 35 30 Q30 25 35 20" fill="none" stroke="#E8DCC8" stroke-width="0.5" opacity="0.6"/>
                      </pattern>
                    </defs>
                    <!-- 뚜껑과 같은 삼각형 모양 - 약간 작게 -->
                    <path d="M20 18C22 20 25 22 30 25L160 100C166 103.5 170 103.5 176 100L306 25C311 22 314 20 316 18L314 15H22L20 18Z" fill="url(#damaskPatternTop)" opacity="0.95"/>
                  </svg>
                </div>
              </div>

              <!-- 카드 -->
              <div id="envelope-card" class="scene" style="
                visibility: inherit;
                width: 220px;
                height: 340px;
                position: absolute;
                top: 50%;
                left: 50%;
              ">
                <div class="envelope-card-inner">
                  <div class="card-header-small">
                    <div class="header-decoration">✦</div>
                  </div>
                  <div class="card-content">
                    <h3 class="card-title">You're Invited</h3>
                    <p class="card-subtitle">To a Special Event</p>
                  </div>
                </div>
              </div>

            </div>

          </div>
        </div>

      </div>
    </div>

    <!-- Replay Button -->
    <button class="replay-btn" onclick="replayAnimation()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
      </svg>
    </button>
  </div>

  <script>
    // 상태 변수
    let phase = 'initial';
    let hasStarted = false;

    // DOM 요소
    const envelope = document.getElementById('envelope');
    const envelopeFlapContainer = document.getElementById('envelope-flap-container');
    const envelopeCard = document.getElementById('envelope-card');

    // 초기 스타일 설정
    envelope.style.transform = 'translateX(-50%) translateY(calc(-50% - 28%)) scale(1.0)';
    envelope.style.transition = 'all 2s cubic-bezier(0.445, 0.05, 0.55, 0.95)';
    envelope.style.zIndex = '1';

    envelopeFlapContainer.style.transform = 'rotateX(0deg)';
    envelopeFlapContainer.style.zIndex = '5';

    envelopeCard.style.transform = 'translateX(-50%) translateY(-50%) translateZ(-0.1px) rotate(-90deg) scale(0.95)';
    envelopeCard.style.transition = 'all 1.5s cubic-bezier(0.445, 0.05, 0.55, 0.95)';
    envelopeCard.style.zIndex = '1';

    // 애니메이션 실행
    function playAnimation() {
      if (hasStarted) return;
      hasStarted = true;

      // Step 1: 뚜껑 열리기 시작
      setTimeout(() => {
        phase = 'start';
        envelopeFlapContainer.style.transform = 'rotateX(180deg)';
        envelopeFlapContainer.style.zIndex = '5';
      }, 0);

      // Step 2: 뚜껑 완전히 열림 (극적인 줌인)
      setTimeout(() => {
        phase = 'flap-open';
        envelopeFlapContainer.style.zIndex = '-1';
        envelope.style.transform = 'translateX(-50%) translateY(calc(-50% + 210%)) scale(2.0)';
        envelope.style.zIndex = '0';
      }, 750);

      // Step 3: 카드 슬라이드 (가로 상태로 위로 이동, z-index 유지)
      setTimeout(() => {
        phase = 'card-slide';
        envelopeCard.style.transform = 'translateX(-50%) translateY(-140%) translateZ(10px) rotate(-90deg) scale(1)';
      }, 1260);

      // Step 4: 카드 회전 (봉투 밖에서 세로로 회전)
      setTimeout(() => {
        phase = 'card-rotate';
        envelopeCard.style.zIndex = '10';
        envelopeCard.style.transition = 'all 0.8s cubic-bezier(0.445, 0.05, 0.55, 0.95)';
        envelopeCard.style.transform = 'translateX(-50%) translateY(-130%) translateZ(20px) rotate(0deg) scale(1)';
      }, 2250);
    }

    // 봉투 클릭 이벤트
    envelope.addEventListener('click', () => {
      if (!hasStarted) {
        envelope.style.cursor = 'default';
        playAnimation();
      }
    });

    // 리플레이 함수
    function replayAnimation() {
      location.reload();
    }
  </script>
</body>
</html>
